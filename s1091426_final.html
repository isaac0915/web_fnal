

<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>期末project</title>
  <style>
  .title3{
font-family:微軟正黑體;font-size:50px;color:white;text-align:center;;
}
    .BettingArea {
      background-color: lightgreen;
      border-collapse: collapse;
      width: 600px;
    }

    div {
      /*float: left;*/
      margin: 0 100px;
    }

    #MoneyTable {
      width: 600px;
      text-align: center;
      font-size: 30px
    }

    #ActionTable {
      width: 600px;
      text-align: center;
      font-size: 50px
    }

    #numberTable {
      width: 600px;
    }

    #evenOddTable {
      width: 600px;
    }
	

    td, th {
      border: 3px solid white;
      text-align: center;
      padding: 8px;
      font-family: 微軟正黑體;

    }

    #InfoTable {
      font-size: 30px
    }


    .NumberCell {
      width: 150px;
    }

    .ActionCell:hover {
      background-color:lightgreen;
    }

    body {
      background-color: #660800;
    }


    .button {
	font-family:微軟正黑體;
      border-radius: 4px;
      background-color: #f4511e;
      border: none;
      color: #FFFFFF;
      text-align: center;
      font-size: 20px;
      padding: 20px;
      width: 150px;
      transition: all 0.5s;
      cursor: pointer;

    }

    .button span {
      cursor: pointer;
      display: inline-block;
      position: relative;
      transition: 0.5s;
    }

    .button span:after {
      content: '\00bb';
      position: absolute;
      opacity: 0;
      top: 0;
      right: -20px;
      transition: 0.5s;
    }

    .button:hover span {
      padding-right: 25px;
    }

    .button:hover span:after {
      opacity: 1;
      right: 0;
    }

   

    #BetInfoDiv {
      background-color: black;
	  float: right;
    }

    #BetInfo {
      font-size: 30px;
      color: white;
      font-family: Consolas, serif;
      font-weight: bold;
	  position:absolute;
	  right:250px;
    }

  </style>
</head>
<div class="title3">賭博gogo</div>
<body>
<div id="BetInfoDiv">
  <p id="BetInfo">0</p>
</div>


<div class="RightArea" id="RightArea">
  <canvas id="canvas" width="500" height="500"></canvas>
</div>

<div class="BettingArea" id="BettingArea">

  <table id="InfoTable">
    <tr>
      <!--<td width="200px" id="Bet">0</td>-->
      <!--<td width="200px" id="BetNumber">0</td>-->
      <td width="600px" id="Money">0</td>
    </tr>
  </table>

  <table id="MoneyTable">  
    <tr>
      <td width="200px" onclick="setBet(this,10);">10$</td>
      <td width="200px" onclick="setBet(this,100);">100$</td>
      <td width="200px" onclick="setBet(this,500);">500$</td>
    </tr>
  </table>
  <table id="numberTable">
    <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,1);">col1</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,2);">col2</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,3);">col3</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,4);">col4</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,5);">col5</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,6);">col6</td>
    </tr>

    <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,1);">1</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,2);">2</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,3);">3</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,4);">4</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,5);">5</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,6);">6</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'row1');">row1</td>
    </tr>
    <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,7);">7</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,8);">8</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,9);">9</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,10);">10</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,11);">11</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,12);">12</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'row2');">row2</td>
    </tr>
    <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,'13');">13</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'14');">14</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'15');">15</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'16');">16</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,'17');">17</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'18');">18</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'row3');">row3</td>
    </tr>
    <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,19);">19</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,20);">20</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,21);">21</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,22);">22</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,23);">21</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,24);">24</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'row4');">row4</td>
    </tr>
	 <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,25);">25</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,26);">26</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,27);">27</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,28);">28</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,29);">29</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,30);">30</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'row5');">row5</td>
    </tr>
	 <tr>
      <td class="NumberCell" width="60" onclick="setNumber(this,31);">31</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,32);">32</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,33);">33</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,34);">34</td>
	  <td class="NumberCell" width="60" onclick="setNumber(this,35);">35</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,36);">36</td>
      <td class="NumberCell" width="60" onclick="setNumber(this,'row6');">row6</td>
    </tr>
  </table>

  <table id="evenOddTable">
    <tr>
      <td class="NumberCell" width="300" onclick="setNumber(this,13);">EVEN</td>
      <td class="NumberCell" width="300" onclick="setNumber(this,14);">ODD</td>
    </tr>
  </table>
  
  <table id="evenOddTable">
    <tr>
      <td class="NumberCell" width="300" onclick="setNumber(this,15);">1~18</td>
      <td class="NumberCell" width="300" onclick="setNumber(this,16);">19~36</td>
    </tr>
  </table>
  
  

  <table id="ActionTable">
    <tr>
      <td class="ActionCell" width="300" onclick="spin();">
        <button class="button"><span>Start </span></button>
      </td>
      <td class="ActionCell" width="300" onclick="reset();">
        <button class="button"><span>Reset </span></button>
      </td>
    </tr>
  </table>

</div>


<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>

<script>
  // stuff for roulette wheel
  var options = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16","17","18","19","20","21","22","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","W", "L"];
  var startAngle = 0;
  var arc = Math.PI / (options.length / 2);
  var spinTimeout = null;
  var canvas = document.getElementById("canvas");
  var ctx = canvas.getContext("2d");
  var spinTime = 0;
  var spinTimeTotal = 0;
  var spinAngleStart;
  var spinResult;

  // set action to do when spin button is clicked
  function spin() {
    spinAngleStart = Math.random() * 10 + 10;
    spinTime = 0;
    spinTimeTotal = Math.random() * 3 + 4 *10000;
    rotateWheel();
  }

  function drawRouletteWheel() {
    // clear space
    ctx.clearRect(0, 0, 500, 500);
    ctx.strokeStyle = "white";
    ctx.lineWidth = 5;

    ctx.font = 'bold 25px Helvetica, Arial';

    const outsideRadius = 240;
    const textRadius = 200;
    const insideRadius = 150;

    // draw wheel
    for (let i = 0; i < options.length; i++) {
      let angle = startAngle + i * arc;

      if (i % 2 === 0) ctx.fillStyle = '#FF0000';
      else ctx.fillStyle = '#000000';
      ctx.beginPath();
      ctx.arc(250, 250, outsideRadius, angle, angle + arc, false);
      ctx.arc(250, 250, insideRadius, angle + arc, angle, true);
      ctx.stroke();
      ctx.fill();
      ctx.save();
      ctx.shadowOffsetX = -1;
      ctx.shadowOffsetY = -1;
      ctx.shadowBlur = 0;
      ctx.shadowColor = "rgb(220,220,220)";
      ctx.fillStyle = "white";
      ctx.translate(250+ Math.cos(angle + arc / 2) * textRadius,
          250 + Math.sin(angle + arc / 2) * textRadius);
      ctx.rotate(angle + arc / 2 + Math.PI / 2);
      let text = options[i];
      ctx.fillText(text, -ctx.measureText(text).width / 2, 0);
      ctx.restore();
    }

    // draw arrow
    ctx.fillStyle = "yellow";
    ctx.beginPath();
    ctx.moveTo(250 - 4, 250 - (outsideRadius + 5));
    ctx.lineTo(250 + 4, 250 - (outsideRadius + 5));
    ctx.lineTo(250 + 4, 250 - (outsideRadius - 5));
    ctx.lineTo(250 + 9, 250 - (outsideRadius - 5));
    ctx.lineTo(250, 250 - (outsideRadius - 13));
    ctx.lineTo(250 - 9, 250 - (outsideRadius - 5));
    ctx.lineTo(250 - 4, 250 - (outsideRadius - 5));
    ctx.lineTo(250 - 4, 250 - (outsideRadius + 5));
    ctx.fill();
    ctx.restore();
  }

  function rotateWheel() {
    rouletteWheelLock = true;
    spinTime += 225;
    if (spinTime >= spinTimeTotal) {
      stopRotateWheel();
      return;
    }
    const spinAngle = spinAngleStart - slowDown(spinTime, 0, spinAngleStart, spinTimeTotal);
    startAngle += (spinAngle * Math.PI / 180);
    drawRouletteWheel();
    spinTimeout = setTimeout('rotateWheel()', 30);
  }

  function stopRotateWheel() {
    clearTimeout(spinTimeout);
    const degrees = startAngle * 180 / Math.PI + 90;
    const arcd = arc * 180 / Math.PI;
    const index = Math.floor((360 - degrees % 360) / arcd);
    ctx.save();
    ctx.font = 'bold 50px Helvetica, Arial';
    ctx.fillStyle = 'white';
    spinResult = options[index];
    const text = options[index];
    ctx.fillText(text, 250 - ctx.measureText(text).width / 2, 250 + 10);
    ctx.restore();
    checkResult();
    clear();
    setView();
    rouletteWheelLock = false;
  }

  function slowDown(t, b, c, d) {
    const ts = (t /= d) * t;
    const tc = ts * t;
    return b + c * (tc + -3 * ts + 3 * t);
  }

  drawRouletteWheel();

  class Bet {
    constructor(id, money) {
      this.id = id;
      this.money = money;
    }
  }

  var bets = [];

  var money = 1000;
  document.getElementById('Money').innerHTML = money;
  var currentBet = 0;
  var selectedNum = 0;
  var rouletteWheelLock = false;
  var betsInfo = '';

  function setBet(object, amount) {
    if (rouletteWheelLock) return;
    currentBet = amount;
    $("#MoneyTable td").css({"background-color": "white"});
    object.style.backgroundColor = 'yellow';
  }

  function setNumber(object) {
    if (rouletteWheelLock || currentBet === 0) return;
    if (money < currentBet) {
      alert("破產了!");
      return;
    }
    let bet = new Bet(object.innerText, currentBet);
    bets.push(bet);
    money -= currentBet;
    document.getElementById('Money').innerHTML = "You Have " + money+" Dollars.";
    object.style.backgroundColor = '#FFCCCC';

    betsInfo = '';

    for (let i = 0; i < bets.length; ++i) {
      let str = "你押了: " + bets[i].id + ", 押注金額: " + bets[i].money + "\n";
      betsInfo += str;
    }
    document.getElementById('BetInfo').innerText = betsInfo;
  }

  // game logic
  /*
  game rule:
  數字共1~16
  prize:
  single number: bet*16
  row or col: bet*4
  odd or even (red or black): bet*2
   */
  function checkResult() {
    // if WIN, get back money + bet
    if (spinResult === 'W') {
      let totalBet = 0;
      bets.forEach(function (bet) {
        totalBet += bet.money;
      });
      money += totalBet * 2;
	  alert("恭喜你中特別獎!");
    } else if (bets.length > 0) {
      for (let i = 0; i < bets.length; ++i) {
        // if single number same
        if (bets[i].id == spinResult)
		{
          money += bets[i].money * 36;alert("恭喜中獎");
        }
		else if (bets[i].id === 'row1' && (spinResult === '1' || spinResult === '2' || spinResult === '3' || spinResult === '4'|| spinResult === '5'|| spinResult === '6'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        } 
		else if (bets[i].id === 'row2' && (spinResult === '7' || spinResult === '8' || spinResult === '9' || spinResult === '10'|| spinResult === '11'|| spinResult === '12')) 
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'row3' && (spinResult === '13' || spinResult === '14' || spinResult === '15' || spinResult === '16'|| spinResult === '17'|| spinResult === '18')) 
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        } 
		else if (bets[i].id === 'row4' && (spinResult === '19' || spinResult === '20' || spinResult === '21' || spinResult === '22'|| spinResult === '23'|| spinResult === '24')) 
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        } 
		else if (bets[i].id === 'row5' && (spinResult === '25' || spinResult === '26' || spinResult === '27' || spinResult === '28'|| spinResult === '29'|| spinResult === '30')) 
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'row6' && (spinResult === '31' || spinResult === '32' || spinResult === '33' || spinResult === '34'|| spinResult === '35'|| spinResult === '36'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'col1' && (spinResult === '1' || spinResult === '7' || spinResult === '13' || spinResult === '19'|| spinResult === '25'|| spinResult === '31'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'col2' && (spinResult === '2' || spinResult === '8' || spinResult === '14' || spinResult === '20'|| spinResult === '26'|| spinResult === '32'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'col3' && (spinResult === '3' || spinResult === '9' || spinResult === '15' || spinResult === '21'|| spinResult === '27'|| spinResult === '33'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'col4' && (spinResult === '4' || spinResult === '10' || spinResult === '16' || spinResult === '22'|| spinResult === '28'|| spinResult === '34'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'col5' && (spinResult === '5' || spinResult === '11' || spinResult === '17' || spinResult === '23'|| spinResult === '29'|| spinResult === '35'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'col6' && (spinResult === '6' || spinResult === '12' || spinResult === '18' || spinResult === '24'|| spinResult === '30'|| spinResult === '36'))
		{
          money += bets[i].money * 6;alert("恭喜中獎");
        }
		else if (bets[i].id === 'EVEN' && ((parseInt(spinResult, 10) % 2 === 0)))
		{
          money += bets[i].money * 2;alert("恭喜中獎");
        }
		else if (bets[i].id === 'ODD' && ((parseInt(spinResult, 10) % 2 === 1)))
		{
          money += bets[i].money * 2;alert("恭喜中獎");
        }
		else if (bets[i].id === '1~18' && (spinResult === '1'||spinResult === '2'||spinResult === '3'||spinResult === '4'||spinResult === '5'||spinResult === '6'||spinResult === '7'||
		spinResult === '8'||spinResult === '9'||spinResult === '10'||spinResult === '11'||spinResult === '12'||spinResult === '13'||spinResult === '14'||spinResult === '15'||spinResult === '16'||spinResult === '17'||spinResult === '18'))
		{
          money += bets[i].money * 2;alert("恭喜中獎");
        }
		else if (bets[i].id === '19~36' && (spinResult === '19'||spinResult === '20'||spinResult === '21'||spinResult === '22'||spinResult === '23'||spinResult === '24'||spinResult === '25'||
		spinResult === '26'||spinResult === '27'||spinResult === '28'||spinResult === '29'||spinResult === '30'||spinResult === '31'||spinResult === '32'||spinResult === '33'||spinResult === '34'||spinResult === '35'||spinResult === '36'))
		{
          money += bets[i].money * 2;alert("恭喜中獎");
        }
      }
    }
    clear();
    setView();
    // if LOSE or number wrong, win nothing
  }

  // view stuff
  function clear() {
    selectedNum = 0;
    currentBet = 0;
    bets = [];
  }

  function reset() {
    if (rouletteWheelLock) return;
    selectedNum = 0;
    currentBet = 0;
    money = 1000;
    clear();
    setView();
  }

  function setView() {
    document.getElementById('BetInfo').innerText = 'EMPTY';
    document.getElementById('Money').innerHTML = "You Have " + money+" Dollars.";
    $("#numberTable td").css({"background-color": "white"});
    $("#MoneyTable td").css({"background-color": "white"});
    $("#evenOddTable td").css({"background-color": "white"});
  }

  reset();
</script>
</body>
</html>